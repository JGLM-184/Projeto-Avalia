<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Teste CRUD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">

<div class="container">
    <h1 class="mb-4">CRUD de Cursos, Disciplinas e Questões</h1>

    <!-- ====================== CURSOS ====================== -->
    <h2>Cursos</h2>
    <table class="table table-bordered">
        <thead>
        <tr><th>ID</th><th>Nome</th><th>Ações</th></tr>
        </thead>
        <tbody>
        <tr th:each="curso : ${cursos}">
            <td th:text="${curso.id}"></td>
            <td th:text="${curso.nome}"></td>
            <td>
                <a th:href="@{/teste/editar-curso/{id}(id=${curso.id})}" class="btn btn-sm btn-primary">Editar</a>
                <a th:href="@{/teste/excluir-curso/{id}(id=${curso.id})}" class="btn btn-sm btn-danger">Excluir</a>
            </td>
        </tr>
        </tbody>
    </table>

    <h3 th:if="${isEdicaoCurso != true}">Criar Curso</h3>
    <form th:if="${isEdicaoCurso != true}" th:action="@{/teste/salvar-curso}" method="post" class="mb-4">
        <div class="mb-3">
            <input type="text" name="nome" class="form-control" placeholder="Nome do curso" required />
        </div>
        <button type="submit" class="btn btn-success">Salvar</button>
    </form>

    <h3 th:if="${isEdicaoCurso == true}">Editar Curso</h3>
    <form th:if="${isEdicaoCurso == true}" th:action="@{'/teste/atualizar-curso/' + ${cursoDTO.id}}" method="post" class="mb-4">
        <div class="mb-3">
            <input type="text" name="nome" class="form-control" th:value="${cursoDTO.nome}" placeholder="Nome do curso" required />
        </div>
        <button type="submit" class="btn btn-success">Atualizar</button>
    </form>

    <!-- ====================== DISCIPLINAS ====================== -->
    <h2>Disciplinas</h2>
    <table class="table table-bordered">
        <thead>
        <tr><th>ID</th><th>Nome</th><th>Ações</th></tr>
        </thead>
        <tbody>
        <tr th:each="disciplina : ${disciplinas}">
            <td th:text="${disciplina.id}"></td>
            <td th:text="${disciplina.nome}"></td>
            <td>
                <a th:href="@{/teste/editar-disciplina/{id}(id=${disciplina.id})}" class="btn btn-sm btn-primary">Editar</a>
                <a th:href="@{/teste/excluir-disciplina/{id}(id=${disciplina.id})}" class="btn btn-sm btn-danger">Excluir</a>
            </td>
        </tr>
        </tbody>
    </table>

    <h3 th:if="${isEdicaoDisciplina != true}">Criar Disciplina</h3>
    <form th:if="${isEdicaoDisciplina != true}" th:action="@{/teste/salvar-disciplina}" method="post" class="mb-4">
        <div class="mb-3">
            <input type="text" name="nome" class="form-control" placeholder="Nome da disciplina" required />
        </div>
        <button type="submit" class="btn btn-success">Salvar</button>
    </form>

    <h3 th:if="${isEdicaoDisciplina == true}">Editar Disciplina</h3>
    <form th:if="${isEdicaoDisciplina == true}" th:action="@{'/teste/atualizar-disciplina/' + ${disciplinaDTO.id}}" method="post" class="mb-4">
        <div class="mb-3">
            <input type="text" name="nome" class="form-control" th:value="${disciplinaDTO.nome}" placeholder="Nome da disciplina" required />
        </div>
        <button type="submit" class="btn btn-success">Atualizar</button>
    </form>

	<!-- ====================== QUESTÕES ====================== -->
	<h2>Questões</h2>
	<div class="mb-5">
	    <table class="table table-bordered">
	        <thead>
	            <tr>
	                <th>Enunciado</th>
	                <th>Ações</th>
	            </tr>
	        </thead>
	        <tbody>
	            <tr th:each="questao : ${questoes}">
	                <td th:text="${questao.enunciado}"></td>
	                <td>
	                    <a th:href="@{/teste/editar-questao/{id}(id=${questao.id})}" class="btn btn-sm btn-primary">Editar</a>
	                    <a th:href="@{/teste/excluir-questao/{id}(id=${questao.id})}" class="btn btn-sm btn-danger">Excluir</a>
	                </td>
	            </tr>
	        </tbody>
	    </table>
	</div>
	
	<!-- ====================== FORMULÁRIO DE QUESTÃO ====================== -->
	<h3 th:if="${isEdicaoQuestao != true}">Criar Questão</h3>
	<form th:if="${isEdicaoQuestao != true}" th:action="@{/teste/salvar-questao}" th:object="${questaoDTO}" method="post" enctype="multipart/form-data" class="mb-4">	    
	    <div class="mb-3">
	        <label>Enunciado</label>
	        <input type="text" th:field="*{enunciado}" class="form-control" placeholder="Digite o enunciado" required/>
	    </div>
	
	    <div class="mb-3">
	        <label>Curso</label>
	        <select th:field="*{curso}" class="form-select" required>
	            <option th:each="curso : ${cursos}" th:value="${curso.id}" th:text="${curso.nome}"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Disciplina</label>
	        <select th:field="*{disciplina}" class="form-select" required>
	            <option th:each="disciplina : ${disciplinas}" th:value="${disciplina.id}" th:text="${disciplina.nome}"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Autor</label>
	        <select th:field="*{autor}" class="form-select" required>
	            <option th:each="professor : ${professores}" th:value="${professor.id}" th:text="${professor.nome}"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Imagem</label>
	        <input type="file" name="file" class="form-control"/>
	        <div th:if="${questaoDTO.imagem != null}" class="mt-2">
	            <img th:src="@{${questaoDTO.imagem}}" height="200px" width="200px"/>
	        </div>
	    </div>
	
	    <div class="mb-3">
	        <label>Alternativas</label>
	        <div th:each="alt, iterStat : ${questaoDTO.alternativas}" style="margin-bottom: 5px;">
	            <input type="text" th:field="*{alternativas[__${iterStat.index}__].texto}" class="form-control" placeholder="Digite a alternativa"/>
	        </div>
	    </div>
	
	    <button type="submit" class="btn btn-success">Salvar</button>
	</form>
	
	<h3 th:if="${isEdicaoQuestao == true}">Editar Questão</h3>
	<form th:if="${isEdicaoQuestao == true}" th:action="@{'/teste/atualizar-questao/' + ${questaoDTO.id}}" th:object="${questaoDTO}" method="post" enctype="multipart/form-data" class="mb-4">
	
	    <div class="mb-3">
	        <label>Enunciado</label>
	        <input type="text" th:field="*{enunciado}" class="form-control" required/>
	    </div>
	
	    <div class="mb-3">
	        <label>Curso</label>
	        <select th:field="*{curso}" class="form-select" required>
	            <option th:each="curso : ${cursos}" th:value="${curso.id}" th:text="${curso.nome}" th:selected="${questaoDTO.curso != null} ? ${curso.id} == ${questaoDTO.curso.id} : false"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Disciplina</label>
	        <select th:field="*{disciplina}" class="form-select" required>
	            <option th:each="disciplina : ${disciplinas}" th:value="${disciplina.id}" th:text="${disciplina.nome}" th:selected="${questaoDTO.disciplina != null} ? ${disciplina.id} == ${questaoDTO.disciplina.id} : false"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Autor</label>
	        <select th:field="*{autor}" class="form-select" required>
	            <option th:each="professor : ${professores}" th:value="${professor.id}" th:text="${professor.nome}" th:selected="${questaoDTO.autor != null} ? ${professor.id} == ${questaoDTO.autor.id} : false"></option>
	        </select>
	    </div>
	
	    <div class="mb-3">
	        <label>Imagem</label>
	        <input type="file" name="file" class="form-control"/>
	        <div th:if="${questaoDTO.imagem != null}" class="mt-2">
	            <img th:src="@{${questaoDTO.imagem}}" height="200px" width="200px"/>
	        </div>
	    </div>
	
	    <div class="mb-3">
	        <label>Alternativas</label>
	        <div th:each="alt, iterStat : ${questaoDTO.alternativas}" style="margin-bottom: 5px;">
	            <input type="text" th:field="*{alternativas[__${iterStat.index}__].texto}" class="form-control"/>
	        </div>
	    </div>
	
	    <button type="submit" class="btn btn-success">Atualizar</button>
	</form>


</div>

</body>
</html>
